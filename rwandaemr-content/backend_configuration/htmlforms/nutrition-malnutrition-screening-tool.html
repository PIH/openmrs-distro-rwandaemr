<htmlform
        htmlformUuid="775340a6-7236-11f0-88ac-00410ed10de9"
        formUuid="890ccace-7236-11f0-88ac-00410ed10de9"
        formName="malnutrition screening tool"
        formDescription="Nutrition malnutrition screening tool"
        formVersion="0.1"
        formEncounterType="1d2f7e37-6758-40d5-baf5-e38a7acba327"
        formPublished="false"
        formRetired="false"
> <!--
	   Oncology Admission Form
	    Pilot_4July_v1.3NT
		Author:
		Builder: Jberchmas
		started on Aug 28, 2012
	-->
    <style>
        .formName {
            background-color: #e0e0ff;
        }

        .section {
            border: 1px solid #8FABC7;
            width: 99%;
            padding: 2px;
            text-align: left;
            margin-bottom: 10px;
        }

        .disabled {
            color: #D8D8D8;
        }

        .sectionHeader {
            background-color:#3333cc;
            color: white;
            display: block;
            padding: 2px;
            font-weight: bold;
        }

        table.symptoms th {
            text-align: right;
        }

        th.subheader {
            background-color: #8FABC7;
            color: white
        }

        .note {
            color: red;
        }

        td {
            vertical-align: top;
        }

        table.labTable td {
            color: red;
        }

        table.labTable
                td.dateField {
            text-align: right;
        }

        table.identifierTable td {
            padding-right: 10px;
        }

        div.paddedTable span {
            padding-right: 20px;
        }

        .indented {
            padding-left: 20pt;
            padding-right: 20pt;
        }

        .bigIndent {
            padding-left: 40pt;
            padding-right: 10pt;
        }

        .newpage {
            color: #8FABC7;
            font-weight: bold;
        }
        table{
        border-collapse:collapse;
        }
        .disdiv{
        background-color: grey;
        }
    </style>
    <script>
        $j(function() {
               $j('.disdiv').find('input').attr('disabled','true');
        });


  $j(document).ready(function () {

    function calculateMSTScore() {
      let total = 0;

      // Get values from radio groups
      let weightLossVal = parseInt($j("input[name='weightLoss']:checked").val());
      let howMuchLossVal = parseInt($j("input[name='howMuchWeightLoss']:checked").val());
      let appetiteLossVal = parseInt($j("input[name='appetitLoss']:checked").val());

      // Safely add each if it's a number
      if (!isNaN(weightLossVal)) total += weightLossVal;
      if (!isNaN(howMuchLossVal)) total += howMuchLossVal;
      if (!isNaN(appetiteLossVal)) total += appetiteLossVal;

      // Set total score to the Total MST Score field



      if(weightLossVal==0 || weightLossVal ==2){
        $j("#ifWeightLoss").hide();
        if (!isNaN(howMuchLossVal)) total -= howMuchLossVal;
        howMuchLossVal=0;

      }else{
        $j("#ifWeightLoss").show();
        if (!isNaN(weightLossVal)) total -= weightLossVal;
        weightLossVal=0;
      }


        setValue('weightLossScore.value', howMuchLossVal+ weightLossVal);
        setValue('appetiteScore.value', appetiteLossVal);
        setValue('MSTScore.value', total);

       if(total==0 || total==1){
           $j("#zeroToOne").show();
           $j("#twoAndMore").hide();
       }else{
           $j("#zeroToOne").hide();
           $j("#twoAndMore").show();
       }


    }

    // Watch for changes to any relevant input
    $j("input[name='weightLoss'], input[name='howMuchWeightLoss'], input[name='appetitLoss']").on("change", calculateMSTScore);

    // Run once on page load (in case something is already selected)
    calculateMSTScore();
  });


    </script>





    <script type="text/javascript">
        if(jQuery){
         $j(document).ready(function(){
            if ( $j.browser.msie ) {
                $j(":checkbox").click(function(){
                     $j(this).change();
             });
         }
         $j(".enableDisable").each(function(){
             var group = $j(this);
             function disableFn(){
                 group.children("#disabled").fadeTo(250,0.33);
                 group.children("#disabled").find(":checkbox").attr("checked",false); //uncheck
                 group.children("#disabled").find("input[type$='text']").val("");
                 group.children("#disabled").find("input").attr("disabled",true);  //disable
             }
         function enableFn(){
             group.children("#disabled").fadeTo(250,1);
             group.children("#disabled").find("input").attr("disabled",false);
         }
         disableFn();
         $j(this).children("#trigger").find(":checkbox:first").change(function(){
             var checked = $j(this).attr("checked");
             if(checked == true){
                  enableFn();
             }else{
                 disableFn();
             }
         });
        });


         $j(".checkboxGroup").each(function(){
             var group = $j(this);
             var uncheckAll = function(){
                 group.find("input[type$='checkbox']").attr("checked",false);
                 group.find("input[type$='checkbox']").change();
             }
             var uncheckRadioAndAll = function(){
             group.find("#checkboxAll,#checkboxRadio").find("input[type$='checkbox']").attr("checked",false);
             group.find("#checkboxAll,#checkboxRadio").find("input[type$='checkbox']").change();
         }



         group.find("#checkboxAll").find("input").click(
            function(){
                 var flip;
                 var checked = $j(this).siblings(":checkbox:first").attr("checked");
                 if($j(this).attr("name") == $j(this).parents("#checkboxAll:first").find(":checkbox:first").attr("name")){
                     checked = $j(this).attr("checked");
                     flip = checked;
                 }else{
                     flip = !checked;
                 }
                 if($j(this).attr("type") == "text") if(flip == false) flip = !filp; // this is so the user doesn't go to check the checkbox, then uncheck it when they hit the input.
                 uncheckAll();
                 $j(this).parents("#checkboxAll:first").find(":checkbox").attr("checked",flip);
                 $j(this).parents("#checkboxAll:first").find(":checkbox").change();
             }
         );



         group.find("#checkboxRadio").find("input[type$='checkbox']").click(function(){
             uncheckAll();
             $j(this).siblings("input[type$='checkbox']").attr("checked",false);
             $j(this).attr("checked",true);
             $j(this).change();
         });

         group.find("#checkboxCheckbox").click(
             function(){
                 uncheckRadioAndAll();
             }
         );
         });
         });
        }
    </script>




    <section>

        <table border="0" cellspacing="0" cellpadding="6" width="100%">
            <tr>
                <td><b>
                    IMB ID:
                    <lookup class="value" expression="patientIdentifiers.get(&quot;IMB ID&quot;)" />
                    <lookup class="value" expression="patientIdentifiers.get(&quot;IMB Primary Care Registration ID&quot;)" />
                </b></td>
                <td>Date: <encounterDate default="today" disallowMultipleEncountersOnDate ="warn" /></td>
            </tr>
            <tr>
                <td>Nom / Last name: <lookup class="value"
                                             expression="patient.personName.familyName" /></td>
                <td>Pr√©nom/ First name: <lookup class="value"
                                                expression="patient.personName.givenName" /></td>
            </tr>

            <tr>
                <td><img src="/openmrs/moduleResources/rwandareports/images/pihHands.png" align="left"
                         height="65" ></img>
                    <h2>
                        Inshuti Mu Buzima <br /> PIH Rwanda
                    </h2></td>
                <td><strong> malnutrition screening tool </strong> <br /> </td>
            </tr>
            <tr>
                <td>
                    Clinique / Clinic: <encounterLocation />
                    <br/><br/>
                    Clinical Department: <obs conceptId = "c920931b-fa93-4e99-9e36-28e1e4c16cf7"
                                               required="true"/>

                </td>
                <td>
                    Clinicien/Provider:<encounterProvider/>

                </td>
            </tr>
        </table>
    </section>

    <section headerLabel="STEP 1:  QUESTION A AND QUESTION B">
        <table border="1" cellspacing="0" cellpadding="6" width="100%">
            <tr>
                <td> <u>QUESTION A: Have you lost weight recently without trying? </u>
                </td>
            </tr>
            <tr>
                <td>
                    <input type ="radio" name="weightLoss" id="noweightLoss" value="0" required="required"/>
                    <label for="noweightLoss">No</label>
                    <br/>
                      <input type ="radio" name="weightLoss" id="unsureweightLoss" value="2"/>
                    <label for="unsureweightLoss">Unsure</label>
                    <br/>
                    <br/>
                    <input type ="radio" name="weightLoss" id="ifYesUnsureweightLoss" value="1"/>
                    <label for="ifYesUnsureweightLoss">If YES, how much weight (in kg*) have you lost?</label>
                    <span id="ifWeightLoss">
                    <br/>

                        <input type ="radio" name="howMuchWeightLoss" id="1to5howMuchWeightLoss" value="1" />
                        <label for="1to5howMuchWeightLoss">1-5 kg</label>
                         <br/>
                        <input type ="radio" name="howMuchWeightLoss" id="6to10howMuchWeightLoss" value="2"/>
                        <label for="6to10howMuchWeightLoss">6-10kg</label>
                         <br/>
                        <input type ="radio" name="howMuchWeightLoss" id="11to15howMuchWeightLoss" value="3"/>
                        <label for="11to15howMuchWeightLoss">11-15kg</label>
                         <br/>
                        <input type ="radio" name="howMuchWeightLoss" id="above15howMuchWeightLoss" value="4"/>
                        <label for="above15howMuchWeightLoss"> >15</label>
                    </span>
                        <br/><br/>
                        <strong>Weight Loss Score: <obs id="weightLossScore" conceptId = "89a568b9-cccc-4fd4-8c82-95be9303513d"/></strong>
                        <br/>

                </td>
            </tr>
            <tr>
                <td> <u>QUESTION b: Have you been eating poorly because of a decreased appetite? </u>
                </td>
            </tr>
            <tr>
                <td>
                    <input type ="radio" name="appetitLoss" id="noappetitLoss" value="0" required="required"/>
                    <label for="noappetitLoss">No</label>
                    <br/>
                    <input type ="radio" name="appetitLoss" id="yesappetitLoss" value="1" />
                    <label for="yesappetitLoss">Yes</label>


                        <br/><br/>
                    <strong>Appetite Score: <obs id="appetiteScore" conceptId = "2da84b7e-9e8f-4d8c-9667-707a68cc51b1"/> </strong>
                </td>
            </tr>
        </table>
    </section>
    <section headerLabel="STEP 2: TOTAL MST SCORE">
        <table border="1" cellspacing="0" cellpadding="6" width="100%">
            <tr>
                <td>
                    Add Weight Loss AND Appetite Scores
                    <br/><br/>
                    Total MST Score: <obs conceptId="1a14ce3f-3a9c-4165-93ba-1e6515fa76f1" id="MSTScore" />
                </td>
            </tr>

        </table>
    </section>

    <section headerLabel="STEP 3: MANAGEMENT PLAN">
        <table border="1" cellspacing="0" cellpadding="6" width="100%">
            <tr>
                <td>

                    <span id="zeroToOne">
                        <u>Score 0 or 1: </u> Patient not at risk of malnutrition
                        <br/>
                        <label color="red">Action:</label> Monitor weight and  re-screen  weekly
                    </span>
                    <br/><br/>
                    <span id="twoAndMore">
                        <u>Score 2 or more: </u> Patient is at risk of malnutrition
                        <br/>
                        <label color="red">Action:</label> Refer the patient to the nutritionist for full nutritional assessment
                    </span>

                </td>
            </tr>

        </table>
    </section>
    <section headerLabel="ASSESSMENT COMMENTS">
        <table>
            <tr>
                <td>
                    <obs conceptId="3ce888c0-26fe-102b-80cb-0017a47871b2" cols="100" required="true"/>
                </td>
            </tr>
        </table>
    </section>




    <submit />

</htmlform>

